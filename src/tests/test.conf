# We inject a packet into udpreader, parse it, and let instance_buffer read it. We
# extract the message to verify it and then inject it again into a buffer which 
# ipclient reads from. We send it through the network stack to ipserver and then
#  mysql inserts the data. Mysql produces an ACK which is sent back over network
# and we pick it up from another buffer to verify that the message was written.
[instance_udpreader]
module=udpreader
udpr_input_types=be4,be3,be2,be1,sep1,le4,le3,le2,le1,sep2,array2@blob8,msg
udpr_port=2222

[instance_socket]
module=socket
socket_input_types=be4,be3,be2,be1,sep1,le4,le3,le2,le1,sep2,array2@blob8,msg
socket_path=/tmp/rrr_test.sock

[instance_duplicator]
module=duplicator
senders=instance_udpreader

[instance_perl5]
module=perl5
senders=instance_socket
perl5_file=test.pl
perl5_config_sub=config
perl5_process_sub=process

#[instance_python3]
#module=python3
#senders=instance_duplicator
#python3_module=testing
#python3_process_function=process

[instance_buffer_from_perl5]
module=buffer
senders=instance_perl5

[instance_buffer_from_python3]
module=buffer
senders=instance_duplicator

[instance_dummy_input]
module=dummy


[instance_mqtt_broker]
module=mqttbroker

[instance_mqtt_client_publish_5]
module=mqttclient
mqtt_server=localhost
mqtt_publish_rrr_message=yes
mqtt_publish_topic=a/b/c
mqtt_version=5
senders=instance_dummy_input

[instance_mqtt_client_subscribe_5]
module=mqttclient
mqtt_server=localhost
mqtt_version=5
mqtt_subscribe_topics=a/+/#

[instance_mqtt_client_publish_3]
module=mqttclient
mqtt_server=localhost
mqtt_version=3.1.1
mqtt_publish_rrr_message=yes
mqtt_publish_topic=d/e/f
mqtt_qos=2
senders=instance_mqtt_client_subscribe_5

[instance_mqtt_client_subscribe_3]
module=mqttclient
mqtt_server=localhost
mqtt_version=3.1.1
mqtt_receive_rrr_message=yes
mqtt_subscribe_topics=+/e/#
mqtt_qos=0




[instance_ipclient]
module=ipclient
senders=instance_mqtt_client_subscribe_3
ipclient_server_name=localhost
ipclient_server_port=5555
ipclient_src_port=4444

[instance_buffer_msg]
module=buffer
senders=instance_ipclient

[instance_ipserver]
module=ipserver
ipserver_port=5555
senders=instance_mysql

[instance_mysql]
module=mysql
senders=instance_ipserver
mysql_server=localhost
mysql_colplan=array
mysql_user=rrr-testing
mysql_password=cnw97zvewQcj812K
mysql_db=rrr-testing
mysql_table=rrr-test-array-types
mysql_columns=int1,int2,int3,int4,int5,int6,int7,int8,blob_combined,vl_message
mysql_add_timestamp_col=yes
mysql_drop_unknown_messages=yes
mysql_strip_array_separators=yes

[instance_test_module]
module=test_module
